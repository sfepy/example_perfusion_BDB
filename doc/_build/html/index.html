


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Numerical simulation of viscous flow in deformable double porous media &mdash; sfepy_example_BDB 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
 

<meta name="description" content="Numerical simulation of periodic fluid-saturated piezoeletric media">
<meta name="author" content="SfePy Developers">
<meta name="keywords" content="homogenization, piezo, poroelasticity, example, sfepy, fem">


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#">
          

          
            
            <img src="_static/sfepy_logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Numerical simulation of viscous flow in deformable double porous media</a><ul>
<li><a class="reference internal" href="#mathematical-model">Mathematical model</a></li>
<li><a class="reference internal" href="#two-level-homogenization">Two-level homogenization</a></li>
<li><a class="reference internal" href="#homogenization-2nd-level">Homogenization - 2nd level</a></li>
<li><a class="reference internal" href="#numerical-simulation">Numerical simulation</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</div>
            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Connections
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/sfepy/example_BDB"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
                <li class="toctree-l1"><a href="https://doi.org/10.1016/j.camwa.2019.04.004"><i class="fa fa-file-text fa-fw"></i> The Paper</a></li>
            
                <li class="toctree-l1"><a href="https://sfepy.org"><i class="fa fa-external-link fa-fw"></i> SfePy</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">sfepy_example_BDB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Numerical simulation of viscous flow in deformable double porous media</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="numerical-simulation-of-viscous-flow-in-deformable-double-porous-media">
<h1>Numerical simulation of viscous flow in deformable double porous media<a class="headerlink" href="#numerical-simulation-of-viscous-flow-in-deformable-double-porous-media" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mathematical-model">
<h2>Mathematical model<a class="headerlink" href="#mathematical-model" title="Permalink to this headline">¶</a></h2>
<p>We consider a double porous medium which consists of an elastic solid matrix <img class="math" src="_images/math/506bcd89dfc3c96cd1b196b78920468ba0a8a87f.png" alt="\Om_s"/> perforated by
a system of channels filled with an incompressible fluid <img class="math" src="_images/math/a491bee4c0c2361d8fd468bfef5172bb7cbfb1d7.png" alt="\Om_f"/> with interface
<img class="math" src="_images/math/a1267e5e48ac9a32845a5028fcf71d7bbd0fc071.png" alt="\Gamma_{fs}=\overline{\Om_f\cap\Om_s}"/>. These components are
arranged in a periodic lattice at both the micro- and mesoscopic level.  Thus, the porous matrix at the mesoscopic level
can be generated medium can be generated by copies of the microscopic reference unit cell <img class="math" src="_images/math/b015a3f29043a02967603edfb1810446c31e4c6d.png" alt="Y"/> and, subsequently,
macroscopic body can be generated as  alattice of the mesoscopic reference unit cell <img class="math" src="_images/math/4467ff414f374bcbbbd502785f2d69afa007461c.png" alt="Z"/>, see <a class="reference internal" href="#fig-domains"><span class="std std-numref">Fig. 1</span></a>.
Two small scale parameters <img class="math" src="_images/math/cc02288743601ad98ae53d5cfcbc6351ebb53562.png" alt="\veps"/> and <img class="math" src="_images/math/eab31b788b1a41946a2c823f77bd2d09b6e5bc42.png" alt="\delta"/> chracterize micro- and meso-porosities.
At the mesoscopic scale, the periodic structure is formed by fluid filled channels occupying domain Om_c^delta
and by domain <img class="math" src="_images/math/db20d61adffade2cbd2a015d6309d9e5a782aea9.png" alt="\Om_m^\delta=\Om\setminus\Om_c^\delta"/> which is constituted by a microporous material.
In particular, domain <img class="math" src="_images/math/c4da698227ea2092286005e692c8c17b9c070251.png" alt="\Om_p^{\veps,\delta}\in\Om_m^\delta"/> represents micro pores saturated by fluid,
whereas <img class="math" src="_images/math/aa198315086a670aa2faa3b45f63585d9f3f1019.png" alt="\Om_s^{\veps,\delta}=\Om_m^\delta\setminus\Om_p^{\veps,\delta}"/> is the skeleton, see <a class="reference internal" href="#fig-domains"><span class="std std-numref">Fig. 1</span></a>..</p>
<p>To summarize the decompositions,</p>
<div class="math">
<p><img src="_images/math/d2a912366292f0e3835347f414fc236b55ecbbe2.png" alt="&amp;\Om=\Om^\delta_c\cup\Om^\delta_m\cup\Gamma^\delta,\\
\mbox{solid }&amp;\Om_s\in\Om_m^\delta,\\
\mbox{microporosity }&amp;\Om_p^{\veps,\delta}=\Om_m^\delta\setminus\Om_s^{\veps,\delta},\\
\mbox{fluid }&amp;\Om_f=\Om_c^\delta\cup\Om_p^{\veps,\delta}\cup\Gamma_{cp}^{\veps,\delta}.\\"/></p>
</div><p>The superscripts <img class="math" src="_images/math/ac603f5a7dc9cb16ee727f8dc6aee09b944b22dd.png" alt="{}^\veps"/> and <img class="math" src="_images/math/90d8b1477f1a5ac60bcae45ed017b6f1dba0d35e.png" alt="{}^\delta"/> denote the quantities oscillating within the heterogeneous
structure with the period equal to the size of the micro- and mesoscopic periodic unit. However, we drop the superscript
in following text to simplify the notation.</p>
<div class="align-center figure" id="id3">
<span id="fig-domains"></span><a class="reference internal image-reference" href="_images/fig-2level-homog-eps-del.JPG"><img alt="_images/fig-2level-homog-eps-del.JPG" src="_images/fig-2level-homog-eps-del.JPG" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Macroscopic domain <img class="math" src="_images/math/89ee39c803a976102dd790e144a843455ac1ed2e.png" alt="\Omega"/> and decomposition of microscopic domain <img class="math" src="_images/math/b015a3f29043a02967603edfb1810446c31e4c6d.png" alt="Y"/> and mesoscopic domain <img class="math" src="_images/math/4467ff414f374bcbbbd502785f2d69afa007461c.png" alt="Z"/>.</span></p>
</div>
<p>The mechanical behavior of such a structure can be described using the
two-level asymptotic homogenization method, (for more detailed explanaition we  refer to <a class="reference internal" href="#rohan2019" id="id1">[Rohan2019]</a>).</p>
<p>The mechanical properties of the deformable matrix are given by elasticity tensor <img class="math" src="_images/math/e2555865e755e000bb06a8d181347b89d58b27f7.png" alt="\Db=(D_{ijkl})"/> which satisfies
the usual symmetries.</p>
<p>The fluid is characterized by viscosity <img class="math" src="_images/math/e55c594bce43fab130b744bb3f177d80e78b97db.png" alt="\eta"/> which is given by a piece-wise constant function,</p>
<div class="math" id="equation-eq-rescaled">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-eq-rescaled" title="Permalink to this equation">¶</a></span><img src="_images/math/a1b647811b779685b76e8f9a43de74eb25fd8ed4.png" alt="\eta&amp;=\veps^2\eta_p\, \mbox{ in }\Omega_p,\\
\eta&amp;=\eta_c\, \mbox{ in }\Omega_c."/></p>
</div><p>The scaling of the viscosity in micropores <img class="math" src="_images/math/5529d642c1861b6a7978b331c3e124da82692170.png" alt="\Omega_p"/> is the standart consequence of the non-slip boundary
condition on he pore wall.</p>
<p>The  problem of the fluid flow in deformable media at microscopic level is given by the following
equilibrium equations and boundary conditions governing displacement of the solid <img class="math" src="_images/math/1e9a7ca172f1139776356cb3ae5ef7d93e7573de.png" alt="\ub"/> and both the fluid
pressure and velocity fields <img class="math" src="_images/math/8f747ca27ffdc151fa9592a43557b9a171ca2e39.png" alt="(p,\vb^f)"/>:</p>
<div class="math" id="equation-eq-equilibrium">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-eq-equilibrium" title="Permalink to this equation">¶</a></span><img src="_images/math/8d38d45905f6a3b0e3cc0aa75d8589b505525ffc.png" alt="-\nabla\cdot \Db\eeb{\ub} &amp; = \fb^s, \quad \mbox{ in } \Om_{s}, \\
\nb\cdot \Db\eeb{\ub} &amp; =\nb\cdot\sigmab^f, \quad \mbox{ on } \Gamma_{fs}, \\
\nb\cdot \Db\eeb{\ub} &amp; =\nb\cdot\gb^s, \quad \mbox{ on } \partial_\sigma\Omega_{s}, \\
\ub &amp; =\0b, \quad \mbox{ on } \partial_u\Omega_{s}, \\
-\nabla\cdot(2\eta\eeb{\vb^f}-p\Ib) &amp; =\fb^f, \quad \mbox{ in } \Omega_{f}, \\
\nabla\cdot\vb^f &amp; =0, \quad \mbox{ in } \Omega_{f}, \\
\vb^f &amp; =\dot\ub, \quad \mbox{ on } \Gamma_{fs}, \\
\vb^f-\dot{\tilde{\ub}} &amp; =:\wb, \quad \mbox{ on } \partial_{ext}\Om_{f},"/></p>
</div><p>where <img class="math" src="_images/math/9ade8d07de54f5cddeff7481c8141b5924c62bc9.png" alt="\sigmab^f=\veps^2\eta_p\eeb{\vb^f}-p\Ib"/> is the fluid stress, <img class="math" src="_images/math/177c4e7b76ee5edd5a84be406fb06bb33ba69675.png" alt="\eeb{\ub}=(e_{ij}(\ub))"/>
is the strain in the solid with components <img class="math" src="_images/math/e7c80b84a5e364507d3ff6d4bdce7ed938b07948.png" alt="e_{ij}(\ub)=1/2(\partial_ju_i+\partial_iu_j)"/>, <img class="math" src="_images/math/2099ef9700c0573c47cb80308012a9375ea6e7e6.png" alt="\fb^{s,f}"/>
denotes the volume forces in the solid or in the fluid, and <img class="math" src="_images/math/013e7fd83e3ac8d4e66ee8e82a3bd66606f20635.png" alt="\gb^{s,f}"/> is the surfacetraction stresses acting
on the solid part. The relative fluid velocity <img class="math" src="_images/math/228c146adaf5cfa22f3a1b10ba8d669d25dacdec.png" alt="\b=\vb^f-\dot{\tilde{\ub}}"/> in the fluid-filled pores
<img class="math" src="_images/math/a491bee4c0c2361d8fd468bfef5172bb7cbfb1d7.png" alt="\Om_f"/> is defined whit use of a smooth extention <img class="math" src="_images/math/5f87f9a5ad5948566a45a53bc34ff2cf436e92de.png" alt="\tilde{\ub}"/> of the dislacement field <img class="math" src="_images/math/1e9a7ca172f1139776356cb3ae5ef7d93e7573de.png" alt="\ub"/>
from solid  <img class="math" src="_images/math/506bcd89dfc3c96cd1b196b78920468ba0a8a87f.png" alt="\Om_s"/> to whole domain <img class="math" src="_images/math/dc8b9497b7f71adabc0ba773b69dd8698d492665.png" alt="\Om"/>.</p>
</div>
<div class="section" id="two-level-homogenization">
<h2>Two-level homogenization<a class="headerlink" href="#two-level-homogenization" title="Permalink to this headline">¶</a></h2>
<p>Due to the double-porous nature of the medium, we performe two levels of homogenization.
The 1st-level of homogenization concerns the asymptotic analysis <img class="math" src="_images/math/580c1526bbe63c2a5345aeb11061b1192ef8ce84.png" alt="\veps \longrightarrow 0"/> related to the
fluid-structure interaction in microporous structure situated in <img class="math" src="_images/math/4e887d3baf2e5fa6173eb04da8727ff57e4163e6.png" alt="\Omega_m"/>.
We apply the standard homogenization techniques to the above problem. It
results in the limit model for <img class="math" src="_images/math/580c1526bbe63c2a5345aeb11061b1192ef8ce84.png" alt="\veps \longrightarrow 0"/>, where
<img class="math" src="_images/math/cc02288743601ad98ae53d5cfcbc6351ebb53562.png" alt="\veps"/> is the scale parameter relating the microscopic and macroscopic
length scales. The homogenization process leads to local microscopic problems,
defined within a reference periodic cell <img class="math" src="_images/math/b015a3f29043a02967603edfb1810446c31e4c6d.png" alt="Y"/> , and to the mesoscopic problem describing
the behavior of the homogenized matrix at the mesoscopic level. The mesoscopic
problem involves the homogenized material coefficients which are evaluated
using the solutions of the local problems. The 2nd-level of homogenization deals with upsacling from meso-
to macroscopic scale. It results in the limit model for
<img class="math" src="_images/math/fb0469bbe8f5d59babd175b5f9800b275c48484c.png" alt="\delta \longrightarrow 0"/> and subsequently in the local mesoscopic problems on
a reference periodic cell <img class="math" src="_images/math/4467ff414f374bcbbbd502785f2d69afa007461c.png" alt="Z"/>, and in the derivation of the homogenized problem at macroscopic level.
Due to linearity of the problem, the microscopic, mesoscopic and macroscopic problems are decoupled.</p>
<p>The local microscopic responses are given by the following sub-problems which are solved within the periodic
reference cell <img class="math" src="_images/math/b015a3f29043a02967603edfb1810446c31e4c6d.png" alt="Y"/>, see <a class="reference internal" href="#fig-domains"><span class="std std-numref">Fig. 1</span></a>, that is decomposed similarly to the decomposition of
domain <img class="math" src="_images/math/89ee39c803a976102dd790e144a843455ac1ed2e.png" alt="\Omega"/>:</p>
<ul class="simple">
<li>Find <img class="math" src="_images/math/d43eba15ce168c3375ad6ca823bc9c98188372a8.png" alt="\omegab^{ij}"/>, <img class="math" src="_images/math/c062ef3474485a609c2e1decdae496210ec3dad2.png" alt="\omega^{P}"/> such that for all <img class="math" src="_images/math/4290fdff2245255695b54d28686e00c27540b90a.png" alt="\vb"/> for any <img class="math" src="_images/math/0b1204e6e5142f8d225380b28d66ef1eaf4ccf2a.png" alt="i, j = 1, 2, 3"/></li>
</ul>
<div class="math" id="equation-eq-corrs-mic1">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-eq-corrs-mic1" title="Permalink to this equation">¶</a></span><img src="_images/math/b866fd6c94aedfc1759c480260836d989d7448ef.png" alt="\int_{Y_s} \Db \eeby{\omegab^{ij} + \Pib^{ij}}: \eeby{\vb}\,\dV   &amp;= 0, \\
\int_{Y_{s}} \Db \eeby{\omegab^P}: \eeby{\vb}\,\dV &amp;=
-{1\over \vert Y\vert}\int_{\Gamma_Y} \vb \cdot \nb^{[s]}\, \dS,"/></p>
</div><p>where <img class="math" src="_images/math/b9d6619db5b9c1423be39a87ec0f09548d80124d.png" alt="\Pi^{ij}_k = y_j \delta_{ik}"/>.</p>
<ul class="simple">
<li>Find <img class="math" src="_images/math/13311e6060fdc973144ecbe9a6478cda5eb30246.png" alt="\psib^{k}"/>, <img class="math" src="_images/math/aaa7be625e33d7fa0ec1f16cf210323aa0bf94d6.png" alt="{\pi}^{k}"/> such that for all <img class="math" src="_images/math/4290fdff2245255695b54d28686e00c27540b90a.png" alt="\vb"/>,
<img class="math" src="_images/math/29bbfdb1a414e1b1c33eff06aab32ccb0004ecf7.png" alt="q"/> satisfying</li>
</ul>
<div class="math" id="equation-eq-corrs-mic2">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-eq-corrs-mic2" title="Permalink to this equation">¶</a></span><img src="_images/math/734cb4705a554ba6d5aa29bb12b4f7989cc35fc7.png" alt="\int_{Y_f} \eta_p \nabla_y{\psib^{k}}: \nabla_y{\vb}\,\dV - \int_{Y_f} \pi^{k}\nabla_y\cdot\vb \,\dV &amp;=
-\int_{Y_f} v_k\,\dV , \\
\int_{Y_f} q\nabla_y\cdot\psib^{k} \,\dV &amp;= 0."/></p>
</div><p>The microscopic sub-problems are solved with the periodic boundary conditions
and <img class="math" src="_images/math/1f1a5ab2fc9c88440dc694738077a71e23b5ae7e.png" alt="Gamma_Y=\overline{Y}_s\cap\overline{Y}_f"/> is the interface between solid and fluid part of the cell <img class="math" src="_images/math/b015a3f29043a02967603edfb1810446c31e4c6d.png" alt="Y"/>.</p>
<p>With the characteristic responses obtained by solving local sub-problems,
the homogenized material coefficients <img class="math" src="_images/math/348d4032e6134576fc8c1d1f2fa13081a864238e.png" alt="\Ab"/>, <img class="math" src="_images/math/9226a86cc2c65d3a8e08148b7d9f2f09f3c97767.png" alt="\Bb"/>, <img class="math" src="_images/math/be179c23db13466034a115b3ca9444dcac99dd98.png" alt="\Kb"/> and <img class="math" src="_images/math/34e9235181d2490bb1e0f3fabf2899b8d3b54444.png" alt="M"/> can be evaluated
using the following expressions:</p>
<div class="math" id="equation-eq-coefs-mes">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-eq-coefs-mes" title="Permalink to this equation">¶</a></span><img src="_images/math/58053c190167aeaeeec9e092cb72cf3f361f1399.png" alt="A_{ijkl} &amp; = {1\over \vert Y\vert} \left[ \int_{Y_{s}} \Db \eeby{\omegab^{kl} + \Pib^{kl}}: \eebz{\omegab^{ij} + \Pib^{ij}}\,\dV\right],\\
B_{ij} &amp; = \phi_f\delta_{ij}-{1\over \vert Y\vert} \left[\int_{Y_s} \Db \eeby{\omegab^{P}}:\eeby{\Pib^{ij}}\,\dV\right],\\
K_{ij} &amp; = {1\over \vert Y\vert} \int_{Y_f} \nabla_y\psi^i:\nabla_y\psi^i\,\dV,\\
M &amp; = {1\over \vert Y\vert} \left[\int_{Y_s} \Db \eeby{\omegab^{P}}:\eeby{\omegab^{P}} \,\dV \right]."/></p>
</div></div>
<div class="section" id="homogenization-2nd-level">
<h2>Homogenization - 2nd level<a class="headerlink" href="#homogenization-2nd-level" title="Permalink to this headline">¶</a></h2>
<p>At the 2st-level of homogenization, the asymptotic analysis <img class="math" src="_images/math/fb0469bbe8f5d59babd175b5f9800b275c48484c.png" alt="\delta \longrightarrow 0"/> is related to the
interaction  between the homogenized microporous matrix in <img class="math" src="_images/math/4e887d3baf2e5fa6173eb04da8727ff57e4163e6.png" alt="\Omega_m"/> and fluid in channels <img class="math" src="_images/math/1071aa28010968373ff9b29193883189f7c7ee93.png" alt="\Omega_c"/>
at mesoscopic level. By same upscaling procedure as in 1st level of homogenization, we obtain
local mesoscopic problems,
defined within a reference periodic cell <img class="math" src="_images/math/4467ff414f374bcbbbd502785f2d69afa007461c.png" alt="Z"/>,
where we enter the homogenized coefficients obtained by 1st level homogenization.
We also arrive to the global problem describing
the behavior of the homogenized matrix at the macroscopic level.
The homogenized material coefficients describing whichdescribe behavior at macroscopic level are evaluated using the
solutions of the local mesoscopic problems.Due to linearity of the problem, the
microscopic, mesoscopic and macroscopic problems are decoupled.</p>
<p>The local mesoscopic responses are given by the following sub-problems which are solved within the periodic
reference cell <img class="math" src="_images/math/4467ff414f374bcbbbd502785f2d69afa007461c.png" alt="Z"/>, see <a class="reference internal" href="#fig-domains"><span class="std std-numref">Fig. 1</span></a>, that is decomposed similarly to the decomposition of
domain <img class="math" src="_images/math/89ee39c803a976102dd790e144a843455ac1ed2e.png" alt="\Omega"/>:</p>
<ul class="simple">
<li>Find <img class="math" src="_images/math/d43eba15ce168c3375ad6ca823bc9c98188372a8.png" alt="\omegab^{ij}"/>, <img class="math" src="_images/math/c062ef3474485a609c2e1decdae496210ec3dad2.png" alt="\omega^{P}"/> such that for all <img class="math" src="_images/math/4290fdff2245255695b54d28686e00c27540b90a.png" alt="\vb"/> for any <img class="math" src="_images/math/0b1204e6e5142f8d225380b28d66ef1eaf4ccf2a.png" alt="i, j = 1, 2, 3"/></li>
</ul>
<div class="math" id="equation-eq-corrs1">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-eq-corrs1" title="Permalink to this equation">¶</a></span><img src="_images/math/37b24f8feb7c13f3db020b3dd32a97a7c9dab7ca.png" alt="\int_{Z_m} \Ab \eebz{\omegab^{ij} + \Pib^{ij}}: \eebz{\vb}\,\dV   &amp;= 0, \\
\int_{Z_{m}} \Ab \eebz{\omegab^P}: \eebz{\vb}\,\dV - \int_{Z_m} \Bb: \eebz{\vb} \,\dV &amp;=
 -{1\over \vert Z\vert}\int_{\Gamma_z} \vb \cdot \nb^{[m]}\, \dS ,"/></p>
</div><p>where <img class="math" src="_images/math/57af33b35bdb4659cf16917c2a8c5e9785be1a75.png" alt="\Pi^{ij}_k = z_j \delta_{ik}"/>.</p>
<ul class="simple">
<li>Find <img class="math" src="_images/math/4801cb5e362c159a482160c32ac8fade88d1f9cf.png" alt="\pi^k"/>, <img class="math" src="_images/math/9360b3fb28f39ee2944f40d52e9303da31f7779c.png" alt="\vphi^k"/> such that for all <img class="math" src="_images/math/29bbfdb1a414e1b1c33eff06aab32ccb0004ecf7.png" alt="q"/> satisfying</li>
</ul>
<div class="math" id="equation-eq-corrs2">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-eq-corrs2" title="Permalink to this equation">¶</a></span><img src="_images/math/123cd6375f7132c1e974faba1073b23f20dc62c9.png" alt="\int_{Z_{m}} \nabla_z q \Kb \nabla_z \pi^k \,\dV &amp;= -\int_{Z_{m}} \nabla_z q \Kb \nabla_z z_k , \\
\int_{Z_{m}} \nabla_z q \Kb \nabla_z \vphi^k \,\dV &amp;= -{1\over \vert Z\vert}\int_{\Gamma_z} q \nb^{[c]}_k\, \dS ."/></p>
</div><ul class="simple">
<li>Find <img class="math" src="_images/math/5f283bfe0d155f4e014fe6eee73085afc6699e1e.png" alt="\psib^{ij}"/>, <img class="math" src="_images/math/00e26b63d1fcc25243f8f57dbd7578539139e709.png" alt="\hat{\vphi}^{ij}"/> such that for all <img class="math" src="_images/math/4290fdff2245255695b54d28686e00c27540b90a.png" alt="\vb"/>,
<img class="math" src="_images/math/29bbfdb1a414e1b1c33eff06aab32ccb0004ecf7.png" alt="q"/> satisfying</li>
</ul>
<div class="math" id="equation-eq-corrs3">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-eq-corrs3" title="Permalink to this equation">¶</a></span><img src="_images/math/da1ea9e2ddc31b9b5a01bbe471ae4713077efd25.png" alt="\int_{Z_c} 2\eta \eebz{\psib^{ij}}: \eebz{\vb}\,\dV - \int_{Z_c} \hat{\vphi}^{ij}\nabla_z\cdot\vb \,\dV &amp;=
-\int_{Z_{c}} 2\eta \eebz{\Pib^{ij}}: \eebz{\vb}\,\dV , \\
\int_{Z_c} \nabla_z\cdot\psib^{ij} q \,\dV &amp;= -\int_{Z_c} \nabla_z\cdot\Pib^{ij} q \,\dV."/></p>
</div><p>The mesoscopic sub-problems are solved with the periodic boundary conditions
and <img class="math" src="_images/math/7125f843e1a629e70ea0781f4efd4e1ff99df43a.png" alt="\Gamma_{z} = \overline{Z_m} \cap \overline{Z_c}"/> is the interface between
the matrix part <img class="math" src="_images/math/ff5bca66f01026bd35d2a8c7bd06911833a95f49.png" alt="Z_m"/> and canal <img class="math" src="_images/math/f9af8f23e88f112eb70235cfd23ac1ea65dca7e6.png" alt="Z_c"/>.</p>
<p>With the characteristic responses obtained by solving local sub-problems,
the homogenized material coefficients <img class="math" src="_images/math/102d6a790a1e8180608f0fe4a254a0a1577934e6.png" alt="\Acalb"/>, <img class="math" src="_images/math/b796fb4c811e40c395510beabd4a6d1f80e9a454.png" alt="\Bcalb"/>, <img class="math" src="_images/math/35fbcbd7d5d93bd048eba9b449a511f7d79d28e3.png" alt="\Hcalb"/>, <img class="math" src="_images/math/44e0609a8b359a9c004330e7f679d8d3e1ccfb76.png" alt="\Pcalb"/>, <img class="math" src="_images/math/5edd1795bf45fc3992b64987d33f1d18b212dd31.png" alt="\Scalb"/>, and <img class="math" src="_images/math/75ddb9a0b84504a022d1ca27ff3e7c2b27bd3ca6.png" alt="\Mcal"/> can be evaluated
using the following expressions:</p>
<div class="math" id="equation-eq-coefs-mac">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-eq-coefs-mac" title="Permalink to this equation">¶</a></span><img src="_images/math/77b98ae500ef7bc3f8c2c27ec469ef6374e30f72.png" alt="\Acal_{ijkl} &amp; = {1\over \vert Z\vert} \left[ \int_{Z_{m}} \left[\Ab \eebz{\omegab^{kl}
+ \Pib^{kl}}\right]: \eebz{\omegab^{ij} + \Pib^{ij}}\,\dV\right],\\
\Bcal_{ij} &amp; = \phi_c\delta_ij+{1\over \vert Z\vert} \left[\int_{Z_m} \Bb: \eebz{\Pib^{ij}+\omegab^{ij}} \,\dV
- \int_{\Gamma_Z} \nb^{m}\cdot \omegab^{ij} \,\dV\right],\\
\Hcal_{ij} &amp; = {1\over \vert Z\vert} \int_{Z_m} \nabla_z\vphi^j\cdot\Kb\nabla_z\vphi^i\,\dV,\\
\Kcal_{ij} &amp; = {1\over \vert Z\vert} \int_{Z_m} \nabla_z(z_j+\pi^j)\cdot\Kb\nabla_z(z_i+\pi^i)\,\dV,\\
\Pcal_{ij} &amp;= \phi_c\delta_{ij}-{1\over \vert Z\vert}\int_{\Gamma_Z} \pi^i n_j^{m}\, \dS
=\phi_c\delta_{ij}+{1\over \vert Z\vert} \int_{Z_m} \nabla_z\vphi^j\cdot\Kb\nabla_z\vphi^i\,\dV,\\
\Scal_{{ijkl}} &amp;={1\over \vert Z\vert}\left[2\eta\int_{Z_c}\eebz{\psib^{kl}+\Pib^{kl}}:\eebz{\psib^{ij}
+\Pib^{ij}}\,\dV-\int_{Z_c} \hat{\vphi}^{kl}\nabla_z\cdot\Pib^{ij}\, \dV\right],\\
\Mcal &amp;={1\over \vert Z\vert}\left[\int_{Z_m}M\,\dV+ \int_{Z_m} \Bb: \eebz{\omegab^{P}} \,\dV
- \int_{\Gamma_Z} \nb^{c}\cdot \omegab^{P} \,\dV\right]."/></p>
</div><p>All coefficients are symmetric with respect to indices related to strain and strain rate tensors, i.e. <img class="math" src="_images/math/ae18d5b2c7d005bced41ec68bb3d9eeca61679e6.png" alt="a_{ij}=a_{ji}"/>.</p>
<p>The global macroscopic problem is defined in terms of the homogenized
coefficients as: Find the macroscopic displacements <img class="math" src="_images/math/bc02ba60dcefadf9afa170e039c2e07b6e3b2c05.png" alt="\ub^0"/> and
<img class="math" src="_images/math/2618be41287c00fbea7f19e8ffbf9e4c34e0d9b4.png" alt="p^0"/> such that for all <img class="math" src="_images/math/f6ab4975a8f625c5c9ebaafcebee5747c68baa6c.png" alt="\vb^0"/> and <img class="math" src="_images/math/db637ddd2dac011ead7f65985e4e9cc51da8ab09.png" alt="q^0"/></p>
<div class="math" id="equation-eq-macro">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-eq-macro" title="Permalink to this equation">¶</a></span><img src="_images/math/6ee5617767e07ec4a6201b2e9a1dd5494ed2ce5c.png" alt="\int_{\Omega} [\Acalb \eebx{\ub^0} - p^0 \Bcalb^T]: \eebx{\vb^0}\,\dV - \int_{\Omega}\vb^0\cdot\Pcalb^T(\nabla_xp^0-\fb^f) &amp;
- \int_\Omega \vb^0 \Hcalb^T\wb^0\,\dV +\int_{\partial_\sigma\Omega}\bar{\phi}_c\bar{p^0}\nb\cdot\vb^0\,\dV\\
&amp;=  \int_{\Omega} \fb^{blk}\cdot\vb^0 \,\dV+\int_{\partial_\sigma\Omega}\bar{\phi}_m\bar{\phi}_s\gb\cdot\vb^0\,\dV,
+ \int_{\Omega} f \cdot \vb \dV,\\
\int_{\Omega} q^0(\Bcalb:\eebx{\dot\ub^0} + \dot p^0 \Mcal) \dV +\int_\Omega (\Kcalb(\nabla_xp^0-\fb^f)-\Pcalb\wb^0)\,\dV
&amp;= -\int_{\partial_w\Omega} q^0 (\bar\phi_m\bar\phi_f\bar w_n^{mic}+\bar\phi_c\bar w_n^{mes}) \,\dV,\\
\int_{\Omega}\eebx{\thetab^0}:\Scalb\eebx{\wb^0+\dot\ub^0}\,\dV+\int_\Omega\thetab^0\cdot\Pcalb(\nabla_xp^0-\fb^f)\,\dV
+\int_\Omega\Hcalb\wb^0 &amp;=\int_{\partial_p\Omega}\bar\phi_c\bar p^0\nb\cdot\thetab^0\,\dV."/></p>
</div><p>The Dirichlet boundary conditions prescribed for <img class="math" src="_images/math/bc02ba60dcefadf9afa170e039c2e07b6e3b2c05.png" alt="\ub^0"/> and <img class="math" src="_images/math/32a6920fbafd88010aa692d0189470d47c34e21f.png" alt="\wb^0"/> can be imposed,</p>
<div class="math" id="equation-boundary-dir">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-boundary-dir" title="Permalink to this equation">¶</a></span><img src="_images/math/3d6d6e12591619509b861bba63e4c18c73c0595b.png" alt="\ub^0&amp;=\bar{\ub}^0\; \textrm{ on }\partial_u\Om,\\
\wb^0&amp;=\bar{\wb}^0\; \textrm{ on }\partial_w\Om."/></p>
</div><p>The pressure <img class="math" src="_images/math/2618be41287c00fbea7f19e8ffbf9e4c34e0d9b4.png" alt="p^0"/> fulfils zero-means conditions <img class="math" src="_images/math/deae7426dc02291c91ed99b6fb10db894aef2fea.png" alt="\int_\Om p^0=0"/> in thole domain <img class="math" src="_images/math/dc8b9497b7f71adabc0ba773b69dd8698d492665.png" alt="\Om"/>.</p>
<p>The complementary Neumann-type boundary condition are specfied as follows</p>
<div class="math" id="equation-boundary-neu">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-boundary-neu" title="Permalink to this equation">¶</a></span><img src="_images/math/dfaeed4fcb569c10000c02e0dc8696626345f616.png" alt="\nb\cdot(\Acalb \eebx{\ub^0} - p^0 \Bcalb^T)&amp;=-\bar{\phi}_c\bar{p^0}\nb+\bar{\phi}_m\bar{\phi}_s\gb=\0b
\; \textrm{ on }\partial_\sigma\Om,\\
\nb\cdot(\Kcalb(\nabla_xp^0-\fb^f)-\Pcalb\wb^0)&amp;=\bar\phi_m\bar\phi_f\bar w_n^{mic}+\bar\phi_c\bar w_n^{mes}
\; \textrm{ on }\partial_j\Om,\\
\nb\cdot\Scalb\eebx{\wb^0+\dot\ub^0}&amp;=\bar\phi_c\bar{p}^0\nb=\0b\; \textrm{ on }\partial_p\Om."/></p>
</div><p>For the purpose of this example, we simplify the problem <a class="reference internal" href="#equation-eq-macro2">(13)</a>. We consider only steady
state of the problem and omitt all volume froces
<img class="math" src="_images/math/57d340b9097bb734e10ee0c666c241ca042577dc.png" alt="\fb^f"/> and <img class="math" src="_images/math/dd8bf24b08b8337580dee782823fde1137341de9.png" alt="\fb^{blk}"/> and surface tractions <img class="math" src="_images/math/95dd48b8fe694752482e11d7c2c94fb90edc60af.png" alt="\gb"/>. Also we will consider
closed micropores on the whole boundary <img class="math" src="_images/math/f24209dcec86bd9403fdbedab171ee4d1b134d0d.png" alt="\partial\Om"/>, <em>i.e.</em> <img class="math" src="_images/math/e0cca49ababb8f0ae6bf4de343d4963fa0d6c189.png" alt="w_n^{mic}=0"/>.
The problem <a class="reference internal" href="#equation-eq-macro">(10)</a> becomes:
Find the macroscopic displacements <img class="math" src="_images/math/bc02ba60dcefadf9afa170e039c2e07b6e3b2c05.png" alt="\ub^0"/> and
<img class="math" src="_images/math/2618be41287c00fbea7f19e8ffbf9e4c34e0d9b4.png" alt="p^0"/> such that for all <img class="math" src="_images/math/f6ab4975a8f625c5c9ebaafcebee5747c68baa6c.png" alt="\vb^0"/> and <img class="math" src="_images/math/db637ddd2dac011ead7f65985e4e9cc51da8ab09.png" alt="q^0"/></p>
<div class="math" id="equation-eq-macro2">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-eq-macro2" title="Permalink to this equation">¶</a></span><img src="_images/math/e9b476079b03b218e25bd995c705350fbd9a2735.png" alt="\int_{\Omega} [\Acalb \eebx{\ub^0} - p^0 \Bcalb^T]: \eebx{\vb^0}\,\dV - \int_{\Omega}\vb^0\cdot\Pcalb^T\nabla_xp^0
- \int_\Omega \vb^0 \Hcalb^T\wb^0\,\dV&amp;= 0\\
\int_\Omega (\Kcalb\nabla_xp^0-\Pcalb\wb^0)\,\dV
&amp;= -\int_{\partial_w\Omega} q^0 \bar\phi_c\bar w_n^{mes} \,\dV,\\
\int_{\Omega}\eebx{\thetab^0}:\Scalb\eebx{\wb^0}\,\dV+\int_\Omega\thetab^0\cdot\Pcalb\nabla_xp^0\,\dV+\int_\Omega\Hcalb\wb^0 &amp;=0."/></p>
</div></div>
<div class="section" id="numerical-simulation">
<h2>Numerical simulation<a class="headerlink" href="#numerical-simulation" title="Permalink to this headline">¶</a></h2>
<div class="align-center figure" id="id4">
<span id="fig-cells"></span><a class="reference internal image-reference" href="_images/comp_cells.png"><img alt="_images/comp_cells.png" src="_images/comp_cells.png" style="height: 250px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Left - geometric representation of microscopic domain; Riht - geometric representation of mesoscopic domain</span></p>
</div>
<p>To run the numerical simulation, download the
<a class="reference external" href="https://github.com/turjani/example_BDB/archive/example.zip">archive</a>,
unpack it in the main SfePy directory and type:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span class="o">./</span><span class="n">simple</span><span class="o">.</span><span class="n">py</span> <span class="n">example_perfusion_BDB</span><span class="o">/</span><span class="n">perf_BDB_mac</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This invoke the <code class="code docutils literal notranslate"><span class="pre">simply.py</span></code> script which calculates the macroscopic
problem <a class="reference internal" href="#equation-eq-macro2">(13)</a> and calls the homogenization engine that solves the
local subproblems for given parameter <img class="math" src="_images/math/cc02288743601ad98ae53d5cfcbc6351ebb53562.png" alt="\veps"/>, viscosity <img class="math" src="_images/math/e55c594bce43fab130b744bb3f177d80e78b97db.png" alt="\eta"/> and elastic tensor <img class="math" src="_images/math/16b69871597af2d76aa260765851038e46b36ea3.png" alt="\Db"/>. First, it solves subproblems  <a class="reference internal" href="#equation-eq-corrs-mic1">(3)</a> and <a class="reference internal" href="#equation-eq-corrs-mic2">(4)</a>
on microscopic cell <img class="math" src="_images/math/b015a3f29043a02967603edfb1810446c31e4c6d.png" alt="Y"/> (see <a class="reference internal" href="#fig-cells"><span class="std std-numref">Fig. 2</span></a> left) and
evaluates the homogenized
coefficients <a class="reference internal" href="#equation-eq-coefs-mes">(5)</a>. Then, using solution from previous step, it solves subproblems
<a class="reference internal" href="#equation-eq-corrs1">(6)</a>–<a class="reference internal" href="#equation-eq-corrs3">(8)</a> on mesoscopic cell <img class="math" src="_images/math/4467ff414f374bcbbbd502785f2d69afa007461c.png" alt="Z"/> (see <a class="reference internal" href="#fig-cells"><span class="std std-numref">Fig. 2</span></a> right)
and evaluates the homogenized coefficients <a class="reference internal" href="#equation-eq-coefs-mac">(9)</a>. See <a class="reference internal" href="#cimrmanlukesrohan2019" id="id2">[CimrmanLukesRohan2019]</a> for more details related
to the SfePy homogenization engine.</p>
<p>The macroscopic sample is fixed on both left and right side, so that no displacements are
allowed, see <a class="reference internal" href="#fig-bc"><span class="std std-numref">Fig. 3</span></a>. The defromation is induced due to the flow through porous matrix, as the
responce to the prescribed velocity <img class="math" src="_images/math/ff02d82da65521a5e187d6f42aadd7ed0e9602e4.png" alt="\bar\wb_n"/>, see <a class="reference internal" href="#equation-eq-macro2">(13)</a>.</p>
<div class="align-center figure" id="id5">
<span id="fig-bc"></span><a class="reference internal image-reference" href="_images/bcond.png"><img alt="_images/bcond.png" src="_images/bcond.png" style="height: 250px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Boundary conditions applied at the macroscopic level</span></p>
</div>
<p>The resultin macroscopic pressure field <img class="math" src="_images/math/16d9357f04cdca0567a8884727f55e821dad4d00.png" alt="p"/>, displacement <img class="math" src="_images/math/1e9a7ca172f1139776356cb3ae5ef7d93e7573de.png" alt="\ub"/> and the velocity field <img class="math" src="_images/math/ef79ecc766e519ec69bced8315341c572fcedf56.png" alt="\wb"/> are depicted in
<a class="reference internal" href="#fig-macro-results"><span class="std std-numref">Fig. 4</span></a>, where deformation is visualised by deformed wireframe.</p>
<div class="align-center figure" id="id6">
<span id="fig-macro-results"></span><a class="reference internal image-reference" href="_images/results_macro.png"><img alt="_images/results_macro.png" src="_images/results_macro.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Macroscopic sample and the resulting macroscopic fields: left - 3D view of pressure
<img class="math" src="_images/math/16d9357f04cdca0567a8884727f55e821dad4d00.png" alt="p"/>, displacement <img class="math" src="_images/math/1e9a7ca172f1139776356cb3ae5ef7d93e7573de.png" alt="\ub"/> and velocity field <img class="math" src="_images/math/ef79ecc766e519ec69bced8315341c572fcedf56.png" alt="\wb"/>; right - pressure
<img class="math" src="_images/math/16d9357f04cdca0567a8884727f55e821dad4d00.png" alt="p"/>, displacement <img class="math" src="_images/math/1e9a7ca172f1139776356cb3ae5ef7d93e7573de.png" alt="\ub"/> and velocity field <img class="math" src="_images/math/ef79ecc766e519ec69bced8315341c572fcedf56.png" alt="\wb"/> in <img class="math" src="_images/math/f55b50e4c844383204f22dcc8d55b3b436af6cb9.png" alt="xy"/>-crosssection.</span></p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="rohan2019" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Rohan2019]</a></td><td>Rohan E., Turjanicová J., Lukeš V. The Biot–Darcy–Brinkman model of flow
in deformable double porous media; homogenization and numerical modelling.
Computers and Mathematics with applications, 78(9):3044-3066, 2019,
<a class="reference external" href="https://doi.org/10.1016/j.camwa.2019.04.004">DOI:10.1016/j.camwa.2019.04.004</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="cimrmanlukesrohan2019" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[CimrmanLukesRohan2019]</a></td><td>Cimrman R., Lukes V., Rohan E.
Multiscale finite element calculations in Python using SfePy.
Advances in Computational Mathematics, 45(4):1897-1921, 2019,
<a class="reference external" href="https://doi.org/10.1007/s10444-019-09666-0">DOI:10.1007/s10444-019-09666-0</a></td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jana Turjanicová, Vladimír Lukeš, Eduard Rohan

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
